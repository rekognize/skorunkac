{% extends "base.html" %}
{% load crispy_forms_tags %}


{% block content %}

    <div class="container mt-4">

        <div class="row">

            <h2>
                Skor:
                <span class="text-{% if score >= 80 %}success{% elif score >= 50 %}warning{% else %}danger{% endif %}">
                    {{ score }}
                </span>
            </h2>

        </div>

        <div class="row">

            <table>
            {% for cat, scores in scores_by_category %}
                {% with scores.score as score %}
                <tr class="text-{% if score >= 80 %}success{% elif score >= 50 %}warning{% else %}danger{% endif %}">
                    <td>{{ cat.name }}</td>
                    <td>{{ score }}</td>
                </tr>
                {% endwith %}
            {% endfor %}
            </table>

        </div>

        <div class="row mt-4">

            {% if weakest_category.1.score > 90 %}

                <h3>Tebrikler, tüm kategorilerden yüksek puan aldınız!</h3>

            {% else %}

                <h3>
                    En zayıf kategori:
                    {{ weakest_category.0.name }}
                </h3>

            {% endif %}

        </div>

        {% if weakest_category.1.score <= 90 %}

        <div class="row mt-4">
            <h3>{{ weakest_category.0.name }} ile ilgili kaynak onerileri</h3>
        </div>

        <div class="row">

        {% for media in weakest_category.0.media_set.all %}
            <div class="col">
                <iframe width="100%" height="315" src="{{ media.url }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            {% if forloop.counter|divisibleby:2 %}
                <div class="w-100"></div>
            {% endif %}
        {% endfor %}
        </div>

        <div class="row">
            <p class="mt-4">
                <a href="{% url 'init_poll' session_slug=poll.session.slug %}" class="btn btn-primary">Tekrar basla</a>
            </p>
        </div>

        {% endif %}

    </div>

{% endblock %}
